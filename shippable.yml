language: clojure

lein:
  - lein2

before_install:
  - sudo apt-get update
  - sudo apt-get install software-properties-common -y
  - sudo apt-add-repository ppa:ansible/ansible -y
  - sudo apt-get update
  - sudo apt-get install ansible -y
  - sudo apt-get remove --purge riak -y
  - echo "localhost ansible_connection=local" | sudo tee /etc/ansible/hosts

install:
  - git submodule update --init --recursive
  - sudo ansible-playbook shippable-playbook.yml

script:
  - lein deps
  - lein vanity
  - lein bikeshed
  - lein test
  - lein cloverage
